
<!DOCTYPE html>
<html>
<head>
  <title>Subir cat√°logo a Firestore</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>
</head>
<body>
  <h2>üì¶ Subir cat√°logo de art√≠culos a Firestore</h2>
  <input type="file" id="jsonFile" />
  <button onclick="subirCatalogo()">Subir a Firestore</button>
  <pre id="output"></pre>

  <script>
    // Configuraci√≥n de Firebase (ya personalizada)
    const firebaseConfig = {
      apiKey: "AIzaSyDqMtZxhXypN1zL1C1yxEWzZi2IcESVC8s",
      authDomain: "catalogofire.firebaseapp.com",
      projectId: "catalogofire",
      storageBucket: "catalogofire.appspot.com",
      messagingSenderId: "946190549117",
      appId: "1:946190549117:web:37a287527348b6b95ef114"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    async function subirCatalogo() {
      const input = document.getElementById('jsonFile');
      const file = input.files[0];
      const output = document.getElementById('output');

      if (!file) {
        alert("Selecciona un archivo JSON primero.");
        return;
      }

      const reader = new FileReader();
      reader.onload = async function(event) {
        const data = JSON.parse(event.target.result);
        let procesados = 0;

        for (const articulo of data) {
          try {
            await db.collection("articulos").doc(articulo.clave).set({
              nombre: articulo.nombre,
              departamento: articulo.departamento,
              linea: articulo.linea,
              costo: articulo.costo,
              precios: articulo.precios
            }, { merge: true });

            procesados++;
            output.textContent = `‚úÖ ${procesados} art√≠culos subidos...`;
          } catch (error) {
            console.error("‚ùå Error con clave:", articulo.clave, error);
          }
        }

        output.textContent += "\nüéâ Proceso completo.";
      };

      reader.readAsText(file);
    }
  </script>
</body>
</html>
